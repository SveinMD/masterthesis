\begin{figure}[!ht]
\tikzsetnextfilename{spe10_iterations_perm_i_0_0_0_m_1_10_i_50_dt_1to30}
\begin{subfigure}[b]{0.49\textwidth} %%%%%%%%%%% M = 0.1 %%%%%%%%%%%%%%
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/spe10-iterations-s-r-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data}
    \pgfmathsetmacro\yfin{\pgfmathresult}
    \pgfmathsetmacro\yini{5}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=300000,
            ymax=15600000,
            xlabel={dt~[d]},
            ylabel={\#iterations},
            grid=both,
            skip coords between index={\yini}{\yfin}
            ]
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-r-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-t-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-a-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-b-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-i-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =0.1$} \label{fig:spe10_iterations_perm_i_0_0_0_m_1_10_i_50_dt_1to30}
\end{subfigure}%
~
\tikzsetnextfilename{spe10_iterations_perm_i_0_0_0_m_1_10_i_50_dt_40to150}
\begin{subfigure}[b]{0.49\textwidth}
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/spe10-iterations-s-r-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data}
    \pgfmathsetmacro\yfin{5}
    \pgfmathsetmacro\yini{0}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=90000,
            ymax=1000000,
            xlabel={dt~[d]},
            ylabel={\#iterations},
            grid=both,
            skip coords between index={\yini}{\yfin}
            ]
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-r-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-t-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-a-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-b-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-i-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        %\legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =0.1$} \label{fig:spe10_iterations_perm_i_0_0_0_m_1_10_i_50_dt_40to150}
\end{subfigure}%
\vspace{0.3cm} %%%%%%%%%%% M = 1 %%%%%%%%%%%%%%
\tikzsetnextfilename{spe10_iterations_perm_i_0_0_0_m_1_1_i_50_dt_1to30}
\begin{subfigure}[b]{0.49\textwidth}
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/spe10-iterations-s-r-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data}
    \pgfmathsetmacro\yfin{\pgfmathresult}
    \pgfmathsetmacro\yini{5}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=190000,
            ymax=11500000,
            xlabel={dt~[d]},
            ylabel={\#iterations},
            grid=both,
            skip coords between index={\yini}{\yfin}
            ]
         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-r-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-t-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-a-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-b-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-i-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =1$} \label{fig:spe10_iterations_perm_i_0_0_0_m_1_1_i_50_dt_1to30}
\end{subfigure}%
~
\tikzsetnextfilename{spe10_iterations_perm_i_0_0_0_m_1_1_i_50_dt_40to150}
\begin{subfigure}[b]{0.49\textwidth}
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/spe10-iterations-s-r-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data}
    \pgfmathsetmacro\yfin{5}
    \pgfmathsetmacro\yini{0}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=86000,
            ymax=1000000,
            xlabel={dt~[d]},
            ylabel={\#iterations},
            grid=both,
            skip coords between index={\yini}{\yfin}
            ]
         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-r-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-t-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-a-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-b-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-i-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        %\legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =1$} \label{fig:spe10_iterations_perm_i_0_0_0_m_1_1_i_50_dt_40to150}
\end{subfigure}%
\vspace{0.3cm} %%%%%%%%%%% M = 10 %%%%%%%%%%%%%%
\tikzsetnextfilename{spe10_iterations_perm_i_0_0_0_m_10_1_i_50_dt_1to30}
\begin{subfigure}[b]{0.49\textwidth}
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/spe10-iterations-s-r-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data}
    \pgfmathsetmacro\yfin{\pgfmathresult}
    \pgfmathsetmacro\yini{5}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=200000,
            ymax=10000000,
            xlabel={dt~[d]},
            ylabel={\#iterations},
            grid=both,
            skip coords between index={\yini}{\yfin}
            ]
         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-r-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-t-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-a-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-b-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-i-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =10$} \label{fig:spe10_iterations_perm_i_0_0_0_m_10_1_i_50_dt_1to30}
\end{subfigure}%
~
\tikzsetnextfilename{spe10_iterations_perm_i_0_0_0_m_10_1_i_50_dt_40to150}
\begin{subfigure}[b]{0.49\textwidth}
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/spe10-iterations-s-r-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data}
    \pgfmathsetmacro\yfin{5}
    \pgfmathsetmacro\yini{0}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=64000,
            ymax=1000000,
            xlabel={dt~[d]},
            ylabel={\#iterations},
            grid=both,
            skip coords between index={\yini}{\yfin}
            ]
         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-r-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-t-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-a-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-b-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-i-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
        %\legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =10$} \label{fig:spe10_iterations_perm_i_0_0_0_m_10_1_i_50_dt_40to150}
\end{subfigure}%
\caption{\#iterations used to solve case B, Section \ref{section:caseB}, for varying root finders, time steps and viscosity ratios.}
\label{fig:spe10_iterations_perm_i_0_0_0_i_50}
\end{figure}%
%
%\begin{figure}[!ht]
%\centering
%\tikzsetnextfilename{spe10_iterations_perm_i_0_0_0_m_1_10_i_50}
%\begin{subfigure}[b]{0.8\textwidth}
%\begin{tikzpicture}
%    \pgfplotstablegetrowsof{datafiles/spe10-iterations-s-r-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data}
%    \pgfmathsetmacro\yfin{\pgfmathresult - 4}
%    \pgfmathsetmacro\yini{0}
%    \begin{semilogyaxis}[
%            width=0.97\textwidth,
%            height=0.26\textheight,
%            ymin=40000,
%            ymax=30000000,
%            xlabel={dt~[d]},
%            ylabel={\#iterations},
%            grid=both,
%            ]
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-r-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-t-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-a-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-b-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-i-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%                %\addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-g-T-400-m-1-10-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \legend{RF,TR,TR*,B,R}
%    \end{semilogyaxis}
%\end{tikzpicture}%
%\caption{$M =0.1$} \label{fig:spe10_iterations_perm_i_0_0_0_m_1_10_i_50}
%\end{subfigure}%
%\vspace{0.3cm}
%\centering
%\tikzsetnextfilename{spe10_iterations_perm_i_0_0_0_m_1_1_i_50}
%\begin{subfigure}[b]{0.8\textwidth}
%\begin{tikzpicture}
%    \begin{semilogyaxis}[
%            width=0.97\textwidth,
%            height=0.26\textheight,
%            ymin=40000,
%            ymax=30000000,
%            xlabel={dt~[d]},
%            ylabel={\#iterations},
%            grid=both,
%            ]
%         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-r-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-t-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-a-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-b-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-i-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%                %\addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-g-T-400-m-1-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \legend{RF,TR,TR*,B,R}
%    \end{semilogyaxis}
%\end{tikzpicture}%
%\caption{$M =1$} \label{fig:spe10_iterations_perm_i_0_0_0_m_1_1_i_50}
%\end{subfigure}%
%\vspace{0.3cm}
%\centering
%\tikzsetnextfilename{spe10_iterations_perm_i_0_0_0_m_10_1_i_50}
%\begin{subfigure}[b]{0.8\textwidth}
%\begin{tikzpicture}
%    \begin{semilogyaxis}[
%            width=0.97\textwidth,
%            height=0.26\textheight,
%            ymin=40000,
%            ymax=30000000,
%            xlabel={dt~[d]},
%            ylabel={\#iterations},
%            grid=both,
%            ]
%         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-r-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-t-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-a-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-b-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-i-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%                %\addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/spe10-iterations-s-g-T-400-m-10-1-dim-10-10-60-220-perm-i-0-0-0-i-50.data};
%        \legend{RF,TR,TR*,B,R}
%    \end{semilogyaxis}
%\end{tikzpicture}%
%\caption{$M =10$} \label{fig:spe10_iterations_perm_i_0_0_0_m_10_1_i_50}
%\end{subfigure}%
%\caption{\#iterations used to solve the Q5 problem, Section \ref{section:caseA}, for varying root finders, time steps and viscosity ratios.}
%\label{fig:spe10_iterations_perm_i_0_0_0_i_50}
%\end{figure}