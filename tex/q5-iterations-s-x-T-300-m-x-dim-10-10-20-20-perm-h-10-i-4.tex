\begin{figure}[!ht]
\tikzsetnextfilename{q5_iterations_perm_h_10_m_1_10_i_4_dt_1to30}
\begin{subfigure}[b]{0.49\textwidth} %%%%%%%%%%% M = 0.1 %%%%%%%%%%%%%%
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/q5-iterations-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data}
    \pgfmathsetmacro\yfin{\pgfmathresult}
    \pgfmathsetmacro\yini{5}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=10000,
            ymax=600000,
            xlabel={dt~[days]},
            ylabel={\#iterations},
            grid=major,
            skip coords between index={\yini}{\yfin}
            ]
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-t-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-a-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-b-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-i-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =0.1$} \label{fig:q5_iterations_perm_h_10_m_1_10_i_4_dt_1to30}
\end{subfigure}%
~
\tikzsetnextfilename{q5_iterations_perm_h_10_m_1_10_i_4_dt_40to150}
\begin{subfigure}[b]{0.49\textwidth}
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/q5-iterations-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data}
    \pgfmathsetmacro\yfin{5}
    \pgfmathsetmacro\yini{0}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=1000,
            ymax=20000,
            xlabel={dt~[days]},
            ylabel={\#iterations},
            grid=major,
            skip coords between index={\yini}{\yfin}
            ]
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-t-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-a-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-b-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-i-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        %\legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =0.1$} \label{fig:q5_iterations_perm_h_10_m_1_10_i_4_dt_40to150}
\end{subfigure}%
\vspace{0.3cm} %%%%%%%%%%% M = 1 %%%%%%%%%%%%%%
\tikzsetnextfilename{q5_iterations_perm_h_10_m_1_1_i_4_dt_1to30}
\begin{subfigure}[b]{0.49\textwidth}
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/q5-iterations-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data}
    \pgfmathsetmacro\yfin{\pgfmathresult}
    \pgfmathsetmacro\yini{5}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=10000,
            ymax=600000,
            xlabel={dt~[days]},
            ylabel={\#iterations},
            grid=major,
            skip coords between index={\yini}{\yfin}
            ]
         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-r-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-t-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-a-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-b-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-i-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =1$} \label{fig:q5_iterations_perm_h_10_m_1_1_i_4_dt_1to30}
\end{subfigure}%
~
\tikzsetnextfilename{q5_iterations_perm_h_10_m_1_1_i_4_dt_40to150}
\begin{subfigure}[b]{0.49\textwidth}
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/q5-iterations-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data}
    \pgfmathsetmacro\yfin{5}
    \pgfmathsetmacro\yini{0}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=1000,
            ymax=20000,
            xlabel={dt~[days]},
            ylabel={\#iterations},
            grid=major,
            skip coords between index={\yini}{\yfin}
            ]
         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-r-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-t-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-a-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-b-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-i-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        %\legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =1$} \label{fig:q5_iterations_perm_h_10_m_1_1_i_4_dt_40to150}
\end{subfigure}%
\vspace{0.3cm} %%%%%%%%%%% M = 10 %%%%%%%%%%%%%%
\tikzsetnextfilename{q5_iterations_perm_h_10_m_10_1_i_4_dt_1to30}
\begin{subfigure}[b]{0.49\textwidth}
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/q5-iterations-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data}
    \pgfmathsetmacro\yfin{\pgfmathresult}
    \pgfmathsetmacro\yini{5}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=8000,
            ymax=600000,
            xlabel={dt~[days]},
            ylabel={\#iterations},
            grid=major,
            skip coords between index={\yini}{\yfin}
            ]
         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-r-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-t-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-a-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-b-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-i-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =10$} \label{fig:q5_iterations_perm_h_10_m_10_1_i_4_dt_1to30}
\end{subfigure}%
~
\tikzsetnextfilename{q5_iterations_perm_h_10_m_10_1_i_4_dt_40to150}
\begin{subfigure}[b]{0.49\textwidth}
\begin{tikzpicture}
    \pgfplotstablegetrowsof{datafiles/q5-iterations-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data}
    \pgfmathsetmacro\yfin{5}
    \pgfmathsetmacro\yini{0}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            ymin=1000,
            ymax=20000,
            xlabel={dt~[days]},
            ylabel={\#iterations},
            grid=major,
            skip coords between index={\yini}{\yfin}
            ]
         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-r-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-t-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-a-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-b-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-i-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        %\legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =10$} \label{fig:q5_iterations_perm_h_10_m_10_1_i_4_dt_40to150}
\end{subfigure}%
\caption{\#iterations used to solve the Q5 problem, Section \ref{section:caseA}, for varying root finders, time steps and viscosity ratios.}
\label{fig:q5_iterations_perm_h_10_i_4}
\end{figure}%
%
%\begin{figure}[!ht]
%\centering
%\tikzsetnextfilename{q5_iterations_perm_h_10_m_1_10_i_4}
%\begin{subfigure}[b]{0.8\textwidth}
%\begin{tikzpicture}
%    \pgfplotstablegetrowsof{datafiles/q5-iterations-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data}
%    \pgfmathsetmacro\yfin{\pgfmathresult - 4}
%    \pgfmathsetmacro\yini{0}
%    \begin{semilogyaxis}[
%            width=0.97\textwidth,
%            height=0.26\textheight,
%            ymin=1000,
%            ymax=1000000,
%            xlabel={dt~[days]},
%            ylabel={\#iterations},
%            grid=major,
%            ]
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-t-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-a-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-b-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-i-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
%                %\addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-g-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
%        \legend{RF,TR,TR*,B,R}
%    \end{semilogyaxis}
%\end{tikzpicture}%
%\caption{$M =0.1$} \label{fig:q5_iterations_perm_h_10_m_1_10_i_4}
%\end{subfigure}%
%\vspace{0.3cm}
%\centering
%\tikzsetnextfilename{q5_iterations_perm_h_10_m_1_1_i_4}
%\begin{subfigure}[b]{0.8\textwidth}
%\begin{tikzpicture}
%    \begin{semilogyaxis}[
%            width=0.97\textwidth,
%            height=0.26\textheight,
%            ymin=1000,
%            ymax=1000000,
%            xlabel={dt~[days]},
%            ylabel={\#iterations},
%            grid=major,
%            ]
%         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-r-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-t-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-a-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-b-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-i-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
%                %\addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-g-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
%        \legend{RF,TR,TR*,B,R}
%    \end{semilogyaxis}
%\end{tikzpicture}%
%\caption{$M =1$} \label{fig:q5_iterations_perm_h_10_m_1_1_i_4}
%\end{subfigure}%
%\vspace{0.3cm}
%\centering
%\tikzsetnextfilename{q5_iterations_perm_h_10_m_10_1_i_4}
%\begin{subfigure}[b]{0.8\textwidth}
%\begin{tikzpicture}
%    \begin{semilogyaxis}[
%            width=0.97\textwidth,
%            height=0.26\textheight,
%            ymin=1000,
%            ymax=1000000,
%            xlabel={dt~[days]},
%            ylabel={\#iterations},
%            grid=major,
%            ]
%         \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-r-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-t-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-a-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-b-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
%        \addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-i-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
%                %\addplot table[col sep=comma, trim cells=true,x=dt, y=iterations] {datafiles/q5-iterations-s-g-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
%        \legend{RF,TR,TR*,B,R}
%    \end{semilogyaxis}
%\end{tikzpicture}%
%\caption{$M =10$} \label{fig:q5_iterations_perm_h_10_m_10_1_i_4}
%\end{subfigure}%
%\caption{\#iterations used to solve the Q5 problem, Section \ref{section:caseA}, for varying root finders, time steps and viscosity ratios.}
%\label{fig:q5_iterations_perm_h_10_i_4}
%\end{figure}