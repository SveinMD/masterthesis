\tikzsetnextfilename{caseA_iterations}
\begin{figure}[ht]
\centering
\begin{tikzpicture}
\begin{axis}[
    width=0.9\textwidth,
    height=0.45\textwidth,
    ybar,
    enlargelimits=0.3,
    legend style={at={(0.5,-0.15)},
      anchor=north,legend columns=-1},
    ylabel={\#iterations},
    symbolic x coords={M=0.1,M=1,M=10},
    xtick=data,
    nodes near coords,
    every node near coord/.append style={
    	font=\scriptsize,
	/pgf/number format/precision=3},
    point meta=y *10^-5
    ]
\addplot table[col sep=comma,trim cells=true,x index=0,y index=1] {datafiles/q5-iterations-s-b-T-300-t-5.data};
\addplot table[col sep=comma,trim cells=true,x index=0,y index=1] {datafiles/q5-iterations-s-r-T-300-t-5.data};
\addplot table[col sep=comma,trim cells=true,x index=0,y index=1] {datafiles/q5-iterations-s-i-T-300-t-5.data};
\addplot table[col sep=comma,trim cells=true,x index=0,y index=1] {datafiles/q5-iterations-s-a-T-300-t-5.data};
\addplot table[col sep=comma,trim cells=true,x index=0,y index=1] {datafiles/q5-iterations-s-g-T-300-t-5.data};
\addplot [color=blue] table[col sep=comma,trim cells=true,x index=0,y index=1] {datafiles/q5-iterations-s-t-T-300-t-5.data};
\legend{B,RF,R,JTR*,GN,JTR}
\end{axis}
\end{tikzpicture}
\caption{Number of iterations spent for six different root finders when solving Case A, see Section \ref{section:caseA}, with viscosity ratio $M = \frac{\mu_w}{\mu_o}$ and time step $\Delta t = \unit[5]{d}$.}
\label{fig:caseA_iterations}
\end{figure}