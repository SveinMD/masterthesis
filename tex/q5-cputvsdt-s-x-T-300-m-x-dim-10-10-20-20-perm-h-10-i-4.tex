\begin{figure}[!ht]
\centering
\tikzsetnextfilename{q5_cputime_perm_h_10_m_1_10_i_4}
\begin{subfigure}[b]{0.8\textwidth}
\begin{tikzpicture}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            xlabel={dt~[d]},
            ylabel={CPU time~[s]},
            grid=both,
            ]
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-r-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-t-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-a-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-b-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-i-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
                %\addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-g-T-300-m-1-10-dim-10-10-20-20-perm-h-10-i-4.data};
        \legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =0.1$} \label{fig:q5_cputime_perm_h_10_m_1_10_i_4}
\end{subfigure}%
\vspace{0.3cm}
\centering
\tikzsetnextfilename{q5_cputime_perm_h_10_m_1_1_i_4}
\begin{subfigure}[b]{0.8\textwidth}
\begin{tikzpicture}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            xlabel={dt~[d]},
            ylabel={CPU time~[s]},
            grid=both,
            ]
         \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-r-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-t-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-a-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-b-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-i-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
                %\addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-g-T-300-m-1-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =1$} \label{fig:q5_cputime_perm_h_10_m_1_1_i_4}
\end{subfigure}%
\vspace{0.3cm}
\centering
\tikzsetnextfilename{q5_cputime_perm_h_10_m_10_1_i_4}
\begin{subfigure}[b]{0.8\textwidth}
\begin{tikzpicture}
    \begin{semilogyaxis}[
            width=0.97\textwidth,
            height=0.26\textheight,
            xlabel={dt~[d]},
            ylabel={CPU time~[s]},
            grid=both,
            ]
         \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-r-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-t-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-a-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-b-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-i-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
                %\addplot table[col sep=comma, trim cells=true,x=dt, y=cputime] {datafiles/q5-cputvsdt-s-g-T-300-m-10-1-dim-10-10-20-20-perm-h-10-i-4.data};
        \legend{RF,TR,TR*,B,R}
    \end{semilogyaxis}
\end{tikzpicture}%
\caption{$M =10$} \label{fig:q5_cputime_perm_h_10_m_10_1_i_4}
\end{subfigure}%
\caption{CPU time used to solve the Q5 problem, Section \ref{section:caseA}, for varying root finders, time steps and viscosity ratios.}
\label{fig:q5_cputime_perm_h_10_i_4}
\end{figure}