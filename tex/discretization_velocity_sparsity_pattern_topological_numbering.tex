\begin{figure}[!ht]
\centering
\tikzsetnextfilename{3x3_grid_topological_numbering}
\begin{subfigure}[b]{0.43\textwidth}
\begin{tikzpicture}
    \node[anchor=south west,inner sep=0] (image) at (0,0) {\includegraphics[width=\textwidth]{figures/3_by_3_grid.png}};
    \begin{scope}[x={(image.south east)},y={(image.north west)}]
        \draw [ultra thick, ->] (0.28,0.16) -- (0.38,0.16);
        \draw [ultra thick, ->] (0.62,0.16) -- (0.72,0.16);
        
        \draw [ultra thick, ->] (0.16,0.3) -- (0.16,0.4);
        \draw [ultra thick, ->] (0.5,0.3) -- (0.5,0.4);
        \draw [ultra thick, ->] (0.83,0.3) -- (0.83,0.4);
        
        \draw [ultra thick, ->] (0.38,0.49) -- (0.28,0.49);
        \draw [ultra thick, ->] (0.62,0.49) -- (0.72,0.49);
        
        \draw [ultra thick, ->] (0.16,0.63) -- (0.16,0.73);
        \draw [ultra thick, ->] (0.5,0.63) -- (0.5,0.73);
        \draw [ultra thick, ->] (0.83,0.63) -- (0.83,0.73);
        
        \draw [ultra thick, ->] (0.38,0.82) -- (0.28,0.82);
        \draw [ultra thick, ->] (0.72,0.82) -- (0.62,0.82);
        
         \node at (0.16,0.16)  (normal) {1};
        \node at (0.5,0.16)  (normal) {2};
        \node  at (0.83,0.16)  (normal) {5};
        
        \node at (0.16,0.49)  (normal) {4};
        \node  at (0.5,0.49)  (normal) {3};
        \node  at (0.83,0.49)  (normal) {6};
        
        \node  at (0.16,0.82)  (normal) {9};
        \node  at (0.5,0.82)  (normal) {8};
        \node  at (0.83,0.82)  (normal) {7};
    \end{scope}
\end{tikzpicture}
\caption{Cell numbering and fluid flow direction.}
\label{fig:discretization_velocity_topological_numbering}
\end{subfigure}%
~
\tikzsetnextfilename{3x3_array_topological_numbering}
\begin{subfigure}[b]{0.5\textwidth}
\centering
\begin{tikzpicture}
	\begin{axis}[%
	width=\textwidth,%
	height=\textwidth,%
	y dir=reverse,%
	xtick=data,%
	ytick=data]%
	\addplot[mark options={blue},only marks]%
	table[col sep=comma, trim cells=true,x=x, y=y] {datafiles/sparsity_pattern_topological_upwind.data};%
	\addplot[mark options={red},only marks]%
	table[col sep=comma, trim cells=true,x=x, y=y] {datafiles/sparsity_pattern_topological_downwind.data};%
	\end{axis}
\end{tikzpicture}
\caption{Sparsity pattern. Downwind cells are shown using red markers.}
\label{fig:sparsity_pattern_topological_numbering}
\end{subfigure}%
\caption{Domain with topological numbering}
\label{fig:discretization_velocity_sparsity_pattern_topological_numbering}
\end{figure}